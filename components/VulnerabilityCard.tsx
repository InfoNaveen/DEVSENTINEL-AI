'use client';

import { motion } from 'framer-motion';
import { ReactNode } from 'react';
import { counterVariants, threatPulse } from '@/lib/motion';

interface VulnerabilityCardProps {
  title: string;
  count: number;
  severity: 'high' | 'medium' | 'low' | 'patch';
  icon: ReactNode;
  index?: number;
}

export function VulnerabilityCard({ title, count, severity, icon, index = 0 }: VulnerabilityCardProps) {
  const getSeverityStyles = () => {
    switch (severity) {
      case 'high':
        return {
          bg: 'bg-red-500/10',
          border: 'border-red-500/30',
          text: 'text-red-400',
          glow: 'glow-red',
          iconBg: 'bg-red-500/20',
          gradient: 'from-red-500/20 to-red-600/10'
        };
      case 'medium':
        return {
          bg: 'bg-yellow-500/10',
          border: 'border-yellow-500/30',
          text: 'text-yellow-400',
          glow: 'glow-yellow',
          iconBg: 'bg-yellow-500/20',
          gradient: 'from-yellow-500/20 to-yellow-600/10'
        };
      case 'low':
        return {
          bg: 'bg-green-500/10',
          border: 'border-green-500/30',
          text: 'text-green-400',
          glow: 'glow-green',
          iconBg: 'bg-green-500/20',
          gradient: 'from-green-500/20 to-green-600/10'
        };
      case 'patch':
        return {
          bg: 'bg-cyan-500/10',
          border: 'border-cyan-500/30',
          text: 'text-cyan-400',
          glow: 'glow-cyan',
          iconBg: 'bg-cyan-500/20',
          gradient: 'from-cyan-500/20 to-blue-600/10'
        };
      default:
        return {
          bg: 'bg-gray-500/10',
          border: 'border-gray-500/30',
          text: 'text-gray-400',
          glow: '',
          iconBg: 'bg-gray-500/20',
          gradient: 'from-gray-500/20 to-gray-600/10'
        };
    }
  };

  const styles = getSeverityStyles();
  const isThreat = severity === 'high' || severity === 'medium';

  return (
    <motion.div
      custom={index}
      variants={counterVariants}
      whileHover={{ scale: 1.02, y: -2 }}
      className={`glass-strong rounded-xl border ${styles.border} overflow-hidden ${styles.bg} hover:shadow-xl transition-all`}
    >
      <div className="p-6">
        <div className="flex items-center justify-between mb-4">
          <motion.div
            variants={isThreat ? threatPulse : undefined}
            animate={isThreat ? 'pulse' : undefined}
            className={`flex-shrink-0 rounded-lg p-3 ${styles.iconBg} ${styles.glow}`}
          >
            <div className={styles.text}>
              {icon}
            </div>
          </motion.div>
          {isThreat && (
            <motion.div
              animate={{ scale: [1, 1.2, 1] }}
              transition={{ duration: 2, repeat: Infinity }}
              className={`h-2 w-2 rounded-full ${styles.text.replace('text-', 'bg-')} ${styles.glow}`}
            />
          )}
        </div>
        <div>
          <dt className="text-sm font-medium text-gray-400 mb-2">
            {title}
          </dt>
          <dd className="flex items-baseline">
            <motion.div
              initial={{ scale: 0 }}
              animate={{ scale: 1 }}
              transition={{ delay: index * 0.1 + 0.2, type: 'spring', stiffness: 200 }}
              className={`text-4xl font-bold ${styles.text} ${isThreat ? 'text-glow-' + severity.replace('high', 'red').replace('medium', 'yellow') : ''}`}
            >
              {count}
            </motion.div>
          </dd>
        </div>
      </div>
      <div className={`h-1 bg-gradient-to-r ${styles.gradient}`} />
    </motion.div>
  );
}
